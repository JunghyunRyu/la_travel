<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA ê°€ì¡± ì—¬í–‰ í”Œë˜ë„ˆ (Royal Palace Westwood)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fdfaf6; /* Warm neutral background */
            color: #333;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }
        .tab-active {
            border-bottom: 3px solid #f59e0b; /* Amber-500 */
            color: #d97706; /* Amber-600 */
            font-weight: 700;
        }
        .tab-inactive {
            color: #6b7280;
            border-bottom: 3px solid transparent;
        }
        .tab-inactive:hover {
            color: #374151;
            border-bottom: 3px solid #e5e7eb;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals with Sunny Amber & Pacific Blue accents (Calm & Family Friendly) -->
    <!-- Application Structure Plan: 
         1. Header: Trip Summary & Key constraints (Child-friendly, Safety).
         2. Interactive Dashboard: 
            - Day Tabs (Day 1, 2, 3) to switch context.
            - Left Column: Chronological Itinerary Cards with "Child Focus" tips.
            - Right Column: Dynamic visualizations.
                a. "Route Map" (Plotly Scatter) showing relative distances from Westwood base.
                b. "Kid's Energy Forecast" (Chart.js Line) predicting fatigue levels based on activity intensity.
         3. Utility Section: Packing Checklist & Safety Tips.
         4. Rationale: Structure allows parents to visualize the flow of the day, understand logistics (distance), and manage the child's condition (energy), which are the user's main concerns. -->
    <!-- Visualization & Content Choices:
         1. Plotly Scatter Plot: To visualize the driving range and direction from the hotel without using heavy Maps APIs. Goal: Show proximity and safety.
         2. Chart.js Line Chart: "Energy Forecast". Goal: Help parents plan rest times. Interaction: Updates per day.
         3. Interactive Timeline: Text cards. Goal: Details. Interaction: Click to expand details.
         4. Checklist: Interactive HTML. Goal: Preparation.
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-[#fdfaf6] min-h-screen pb-12">

    <!-- Header Section -->
    <header class="bg-white card-shadow sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold text-gray-800">LA ê°€ì¡± ì—¬í–‰ í”Œë˜ë„ˆ <span class="text-amber-500 text-lg font-normal ml-2">with 5ì„¸ ì•„ì´</span></h1>
                <p class="text-sm text-gray-500">Royal Palace Westwood Base | 4ì›” 11ì¼ - 14ì¼</p>
            </div>
            <div class="hidden md:block text-right">
                <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">ë Œí„°ì¹´ ì´ë™</span>
                <span class="inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">ì•ˆì „ ì§€ì—­ ìœ„ì£¼</span>
                <span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">ì•„ì´ ë§ì¶¤í˜•</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="max-w-6xl mx-auto px-4 mt-8 grid grid-cols-1 lg:grid-cols-12 gap-8">

        <!-- Introduction -->
        <div class="lg:col-span-12 mb-4">
            <div class="bg-white p-6 rounded-xl card-shadow border-l-4 border-amber-500">
                <h2 class="text-xl font-bold mb-2">ì—¬í–‰ ê°œìš” ë° ì „ëµ</h2>
                <p class="text-gray-600 leading-relaxed">
                    ì´ ëŒ€ì‹œë³´ë“œëŠ” 5ì„¸ ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” 3ë°• 4ì¼ LA ì—¬í–‰ì„ ìœ„í•´ ìµœì í™”ë˜ì—ˆìŠµë‹ˆë‹¤. 
                    <strong>Royal Palace Westwood</strong> í˜¸í…”ì„ ë² ì´ìŠ¤ìº í”„ë¡œ í•˜ì—¬, ì¹˜ì•ˆì´ ìš°ìˆ˜í•œ Westsideì™€ Mid-City ì§€ì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë™ì„ ì„ ì§°ìŠµë‹ˆë‹¤.
                    í˜¼ì¡í•œ ëª…ì˜ˆì˜ ê±°ë¦¬ë¥¼ í”¼í•˜ê³ , ì•„ì´ì˜ ì²´ë ¥ì„ ê³ ë ¤í•˜ì—¬ <strong>'ì˜¤ì „ í™œë™ - ì—¬ìœ ë¡œìš´ ì ì‹¬ - ì˜¤í›„ ëœë“œë§ˆí¬ - ë¹ ë¥¸ ê·€ê°€'</strong> íŒ¨í„´ì„ ìœ ì§€í•©ë‹ˆë‹¤.
                    ì•„ë˜ íƒ­ì„ ëˆŒëŸ¬ ë‚ ì§œë³„ ì„¸ë¶€ ë™ì„ ê³¼ ì˜ˆìƒ ì²´ë ¥ ì†Œëª¨ë¥¼ í™•ì¸í•˜ì„¸ìš”.
                </p>
            </div>
        </div>

        <!-- Left Column: Navigation & Itinerary -->
        <div class="lg:col-span-7 flex flex-col gap-6">
            
            <!-- Day Navigation -->
            <div class="flex space-x-1 border-b border-gray-200">
                <button onclick="switchDay(0)" id="tab-0" class="tab-active flex-1 py-4 px-1 text-center text-sm md:text-base transition-colors duration-200">
                    Day 1<br><span class="text-xs font-normal">4/11 (í† ) - ì˜ˆìˆ ê³¼ ë°”ë‹¤</span>
                </button>
                <button onclick="switchDay(1)" id="tab-1" class="tab-inactive flex-1 py-4 px-1 text-center text-sm md:text-base transition-colors duration-200">
                    Day 2<br><span class="text-xs font-normal">4/12 (ì¼) - ê³µì›ê³¼ ëœë“œë§ˆí¬</span>
                </button>
                <button onclick="switchDay(2)" id="tab-2" class="tab-inactive flex-1 py-4 px-1 text-center text-sm md:text-base transition-colors duration-200">
                    Day 3<br><span class="text-xs font-normal">4/13 (ì›”) - ìœ ë‹ˆë²„ì…œ ìŠ¤íŠœë””ì˜¤</span>
                </button>
            </div>

            <!-- Dynamic Itinerary Content -->
            <div id="itinerary-container" class="space-y-4">
                <!-- Content injected by JS -->
            </div>

            <!-- Smart Tips Section -->
            <div class="bg-blue-50 p-6 rounded-xl border border-blue-100">
                <h3 class="font-bold text-blue-900 mb-3 flex items-center">
                    <span>ğŸ’¡ 5ì„¸ ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” ì—¬í–‰ ê¿€íŒ</span>
                </h3>
                <ul class="space-y-2 text-sm text-blue-800" id="daily-tips">
                    <!-- Tips injected by JS -->
                </ul>
            </div>
        </div>

        <!-- Right Column: Visualizations & Analytics -->
        <div class="lg:col-span-5 flex flex-col gap-6">
            
            <!-- Location Map Visualization -->
            <div class="bg-white p-5 rounded-xl card-shadow">
                <div class="mb-4">
                    <h3 class="font-bold text-gray-800 text-lg">ğŸ—ºï¸ ì˜¤ëŠ˜ì˜ ì´ë™ ë™ì„  (Relative Map)</h3>
                    <p class="text-xs text-gray-500">í˜¸í…”(ì¤‘ì‹¬) ê¸°ì¤€ ì£¼ìš” ë°©ë¬¸ì§€ ìœ„ì¹˜ ë° ê±°ë¦¬ê°</p>
                </div>
                <div id="map-plot" class="w-full h-[300px] bg-gray-50 rounded-lg"></div>
            </div>

            <!-- Kid's Energy Forecast Chart -->
            <div class="bg-white p-5 rounded-xl card-shadow">
                <div class="mb-4">
                    <h3 class="font-bold text-gray-800 text-lg">ğŸ”‹ ì•„ì´ ì²´ë ¥ ì˜ˆì¸¡ ê·¸ë˜í”„</h3>
                    <p class="text-xs text-gray-500">ì‹œê°„ëŒ€ë³„ ì˜ˆìƒ í”¼ë¡œë„ ë° íœ´ì‹ í•„ìš” êµ¬ê°„</p>
                </div>
                <div class="chart-container">
                    <canvas id="energyChart"></canvas>
                </div>
            </div>

            <!-- Interactive Checklist -->
            <div class="bg-white p-5 rounded-xl card-shadow">
                <h3 class="font-bold text-gray-800 text-lg mb-4">ğŸ’ ì˜¤ëŠ˜ì˜ í•„ìˆ˜ ì¤€ë¹„ë¬¼</h3>
                <div id="checklist-container" class="space-y-2">
                    <!-- Checklist injected by JS -->
                </div>
            </div>

        </div>

        <!-- Safety & Driving Info (Bottom Full Width) -->
        <div class="lg:col-span-12 mt-4">
            <div class="bg-gray-800 text-white p-6 rounded-xl shadow-lg">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                    <h3 class="text-lg font-bold text-amber-400">ğŸš— LA ë Œí„°ì¹´ ìš´ì „ ë° ì•ˆì „ ìˆ˜ì¹™</h3>
                    <button onclick="toggleSafetyDetails()" class="text-sm bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded mt-2 md:mt-0 transition">ìƒì„¸ ë³´ê¸° / ì ‘ê¸°</button>
                </div>
                <div id="safety-details" class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-gray-300">
                    <div>
                        <h4 class="font-bold text-white mb-2">ìš´ì „ ì£¼ì˜ì‚¬í•­</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><strong>HOV ë ˆì¸ (ì¹´í’€):</strong> 2ì¸ ì´ìƒ íƒ‘ìŠ¹ ì‹œ ì´ìš© ê°€ëŠ¥. ë‹¤ì´ì•„ëª¬ë“œ í‘œì‹œ í™•ì¸.</li>
                            <li><strong>STOP ì‚¬ì¸:</strong> 3ì´ˆê°„ ì™„ì „íˆ ì •ì§€ í›„ ì¶œë°œ (ì—„ê²© ë‹¨ì†).</li>
                            <li><strong>ë¹„ë³´í˜¸ ì¢ŒíšŒì „:</strong> ë…¹ìƒ‰ ì‹ í˜¸ ì‹œ, ë§ì€í¸ ì§ì§„ ì°¨ëŸ‰ì´ ì—†ì„ ë•Œ ì¢ŒíšŒì „ ê°€ëŠ¥.</li>
                            <li><strong>ìŠ¤ì¿¨ë²„ìŠ¤:</strong> ìŠ¤ì¿¨ë²„ìŠ¤ê°€ 'STOP' í‘œì‹œë¥¼ í´ë©´ ì–‘ë°©í–¥ ëª¨ë‘ ì •ì§€í•´ì•¼ í•¨.</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-white mb-2">ì¹˜ì•ˆ & ì£¼ì°¨</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><strong>ì°¨ëŸ‰ ë‚´ ë¬¼í’ˆ:</strong> ì ˆëŒ€ë¡œ ì°¨ ì•ˆì— ê°€ë°©, ë™ì „, ì˜· ë“±ì„ ë³´ì´ê²Œ ë‘ì§€ ë§ˆì„¸ìš” (ì°½ë¬¸ íŒŒì† ì ˆë„ ì£¼ì˜).</li>
                            <li><strong>ì£¼ì°¨:</strong> ê¸¸ê±°ë¦¬ ì£¼ì°¨ ì‹œ í‘œì§€íŒ(ì£¼ì°¨ ê°€ëŠ¥ ì‹œê°„, ì²­ì†Œ ì‹œê°„) í•„ë…. ê°€ëŠ¥í•œ ìœ ë£Œ ì£¼ì°¨ì¥ ì´ìš© ê¶Œì¥.</li>
                            <li><strong>í”¼í•´ì•¼ í•  ê³³:</strong> ë°¤ëŠ¦ì€ ì‹œê°„ì˜ ë‹¤ìš´íƒ€ìš´ LA, í• ë¦¬ìš°ë“œ ëŒ€ë¡œ ë’·ê³¨ëª©.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center text-gray-400 text-sm py-8 mt-8 border-t border-gray-200">
        <p>4ì›” 14ì¼ì€ ê·€êµ­ì¼ì…ë‹ˆë‹¤. ì•ˆì „í•œ ë¹„í–‰ ë˜ì„¸ìš”! âœˆï¸</p>
    </footer>

    <script>
        // --- Data Definitions ---

        const dayData = [
            {
                // Day 1: Westside
                title: "Day 1: ì˜ˆìˆ ê³¼ ë°”ë‹¤ (Westside)",
                date: "4ì›” 11ì¼ (í† )",
                summary: "ì¥ì‹œê°„ ë¹„í–‰ í›„ ì—¬ìœ ë¡œìš´ ì¼ì •. í˜¸í…” ê·¼ì²˜ì˜ ì˜ˆìˆ  ê³µê°„ê³¼ íƒ íŠ¸ì¸ ë°”ë‹¤ë¡œ íë§í•©ë‹ˆë‹¤.",
                activities: [
                    { time: "10:00", title: "ê²Œí‹° ì„¼í„° (The Getty Center)", desc: "íŠ¸ë¨ íƒ‘ìŠ¹ & ì„¼íŠ¸ëŸ´ ê°€ë“  í”¼í¬ë‹‰. ì•„ì´ë“¤ì´ ë›°ì–´ë†€ê¸° ì¢‹ì€ ì”ë””ë°­ê³¼ LA ì „ê²½ ê°ìƒ.", type: "Walk", icon: "ğŸ›ï¸" },
                    { time: "13:30", title: "ì†Œí…” ì¬íŒ¬íƒ€ìš´ (Sawtelle)", desc: "ì ì‹¬ ì‹ì‚¬ (ìš°ë™, ëˆê¹ŒìŠ¤ ë“±). ë§µì§€ ì•Šì€ ë©”ë‰´ê°€ ë§ê³  ê±°ë¦¬ê°€ ê¹¨ë—í•´ ì•„ì´ì™€ í•¨ê»˜í•˜ê¸° ìµœì .", type: "Food", icon: "ğŸœ" },
                    { time: "15:30", title: "ì‚°íƒ€ëª¨ë‹ˆì¹´ í”¼ì–´ (Santa Monica)", desc: "í¼ì‹œí”½ íŒŒí¬ì˜ ê´€ëŒì°¨ì™€ í•´ë³€ ì‚°ì±…. ëª¨ë˜ë†€ì´ ì§§ê²Œ ì¦ê¸°ê¸°.", type: "Play", icon: "ğŸ¡" },
                    { time: "18:00", title: "ì €ë… ì‹ì‚¬ ë° íœ´ì‹", desc: "ìˆ™ì†Œ ê·¼ì²˜ ì›¨ìŠ¤íŠ¸ìš°ë“œ ë¹Œë¦¬ì§€ì—ì„œ ê°„ë‹¨í•œ ì¥ë³´ê¸° í›„ í˜¸í…” íœ´ì‹.", type: "Rest", icon: "ğŸ¨" }
                ],
                tips: [
                    "ê²Œí‹° ì„¼í„° íŠ¸ë¨ì€ ì•„ì´ë“¤ì´ ì •ë§ ì¢‹ì•„í•©ë‹ˆë‹¤. ìœ ëª¨ì°¨ ëŒ€ì—¬ë„ ê°€ëŠ¥í•´ìš”.",
                    "ì‚°íƒ€ëª¨ë‹ˆì¹´ ì£¼ì°¨ëŠ” í”¼ì–´ ë°”ë¡œ ìœ„ë³´ë‹¤ ì¸ê·¼ ì‡¼í•‘ëª°(Santa Monica Place)ì´ í›¨ì”¬ ì¾Œì í•©ë‹ˆë‹¤.",
                    "í•´ë³€ ë°”ëŒì´ ìŒ€ìŒ€í•  ìˆ˜ ìˆìœ¼ë‹ˆ ê²‰ì˜·ì„ ê¼­ ì±™ê¸°ì„¸ìš”."
                ],
                // Map Coordinates (Relative: Westwood is 0,0)
                mapPoints: [
                    { x: 0, y: 0, name: "í˜¸í…”(Westwood)", color: "#10b981", size: 20 },
                    { x: -0.5, y: 3, name: "ê²Œí‹° ì„¼í„°", color: "#3b82f6", size: 15 },
                    { x: -1, y: -0.5, name: "ì†Œí…”", color: "#f59e0b", size: 12 },
                    { x: -4, y: -2, name: "ì‚°íƒ€ëª¨ë‹ˆì¹´", color: "#ef4444", size: 15 }
                ],
                // Energy Forecast (0-100)
                energyLabels: ["10:00", "12:00", "14:00", "16:00", "18:00", "20:00"],
                energyData: [90, 70, 85, 60, 40, 20], // Dip after lunch, drain at beach
                checklist: [
                    "ì„ ê¸€ë¼ìŠ¤ ë° ì„ í¬ë¦¼", "ì•„ì´ ë°”ëŒë§‰ì´ ìì¼“", "ëª¨ë˜ë†€ì´ í›„ ë‹¦ì„ ìˆ˜ê±´/ë¬¼í‹°ìŠˆ", "í˜¸í…” ë°”ìš°ì²˜ í™•ì¸"
                ]
            },
            {
                // Day 2: Mid-City
                title: "Day 2: ê³µì›ê³¼ ëœë“œë§ˆí¬ (Mid-City)",
                date: "4ì›” 12ì¼ (ì¼)",
                summary: "ë³µì¡í•œ ê³³ì€ í”¼í•˜ê³ , ì•„ì´ê°€ í¥ë¯¸ë¡œì›Œí•  ê³µë£¡ í™”ì„ê³¼ ì „ì°¨, ì²œë¬¸ëŒ€ë¥¼ ë°©ë¬¸í•©ë‹ˆë‹¤.",
                activities: [
                    { time: "10:00", title: "ë¼ë¸Œë ˆì•„ íƒ€ë¥´ í”¼íŠ¸", desc: "ë„ì‹¬ ì† í™”ì„ ë°œêµ´ì§€. ê³µì›(Hancock Park)ì—ì„œ ë›°ì–´ë†€ê³  Urban Light ì¡°í˜•ë¬¼ ì‚¬ì§„ ì´¬ì˜.", type: "Walk", icon: "ğŸ¦•" },
                    { time: "12:30", title: "ë” ê·¸ë¡œë¸Œ & íŒŒë¨¸ìŠ¤ ë§ˆì¼“", desc: "ë¬´ë£Œ íŠ¸ë¡¤ë¦¬(2ì¸µ ì „ì°¨) íƒ‘ìŠ¹. ë¶„ìˆ˜ì‡¼ êµ¬ê²½ ë° ì•¼ì™¸ ì ì‹¬ ì‹ì‚¬.", type: "Food", icon: "ğŸš‹" },
                    { time: "16:00", title: "ê·¸ë¦¬í”¼ìŠ¤ ì²œë¬¸ëŒ€", desc: "í• ë¦¬ìš°ë“œ ì‚¬ì¸ ì¡°ë§ & ìš°ì£¼ ì „ì‹œ. ì¼ëª° ê°ìƒ.", type: "Walk", icon: "ğŸ”­" },
                    { time: "19:00", title: "í˜¸í…” ê·€ê°€", desc: "êµí†µ ì²´ì¦ì„ í”¼í•˜ê¸° ìœ„í•´ ì¡°ê¸ˆ ì„œë‘˜ëŸ¬ ê·€ê°€ í›„ íœ´ì‹.", type: "Rest", icon: "ğŸš—" }
                ],
                tips: [
                    "ê·¸ë¦¬í”¼ìŠ¤ ì²œë¬¸ëŒ€ëŠ” ì£¼ë§ ì£¼ì°¨ê°€ ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤. 'Greek Theatre' ì£¼ì°¨ í›„ ì…”í‹€ ì´ìš©ì„ ì¶”ì²œí•©ë‹ˆë‹¤.",
                    "ë” ê·¸ë¡œë¸Œì˜ íŠ¸ë¡¤ë¦¬ ìš´í–‰ ì‹œê°„ì„ ë¯¸ë¦¬ í™•ì¸í•˜ê³  ì¤„ì„ ì„œì„¸ìš”.",
                    "ë¼ë¸Œë ˆì•„ ê³µì›ì€ ì”ë””ë°­ì´ ë„“ì–´ ì•„ì´ê°€ ë§ˆìŒê» ë›°ì–´ë†€ê¸° ì¢‹ìŠµë‹ˆë‹¤."
                ],
                mapPoints: [
                    { x: 0, y: 0, name: "í˜¸í…”(Westwood)", color: "#10b981", size: 20 },
                    { x: 4, y: 0, name: "ë¼ë¸Œë ˆì•„", color: "#3b82f6", size: 15 },
                    { x: 4.5, y: 0.5, name: "ë” ê·¸ë¡œë¸Œ", color: "#f59e0b", size: 15 },
                    { x: 7, y: 5, name: "ê·¸ë¦¬í”¼ìŠ¤ ì²œë¬¸ëŒ€", color: "#ef4444", size: 15 }
                ],
                energyLabels: ["10:00", "12:00", "14:00", "16:00", "18:00", "20:00"],
                energyData: [95, 80, 85, 60, 50, 30], // Steady day
                checklist: [
                    "í¸ì•ˆí•œ ìš´ë™í™” (ë§ì´ ê±·ìŠµë‹ˆë‹¤)", "íœ´ëŒ€ìš© ìœ ëª¨ì°¨", "ì•„ì´ ê°„ì‹ ë° ë¬¼", "ì¹´ë©”ë¼/ì‚¼ê°ëŒ€"
                ]
            },
            {
                // Day 3: Universal Studios
                title: "Day 3: ìœ ë‹ˆë²„ì…œ ìŠ¤íŠœë””ì˜¤ í• ë¦¬ìš°ë“œ",
                date: "4ì›” 13ì¼ (ì›”)",
                summary: "í•˜ë£¨ ì¢…ì¼ í…Œë§ˆíŒŒí¬ ì¼ì •ì…ë‹ˆë‹¤. 5ì„¸ ì•„ì´ ëˆˆë†’ì´ì— ë§ì¶° 'ìŠˆí¼ ë‹Œí…ë„ ì›”ë“œ'ì™€ 'ë¯¸ë‹ˆì–¸ì¦ˆ' ìœ„ì£¼ë¡œ ê³µëµí•©ë‹ˆë‹¤.",
                activities: [
                    { time: "09:00", title: "ì…ì¥ ë° í•˜ë¶€ ë¡œíŠ¸(Lower Lot)", desc: "ìŠˆí¼ ë‹Œí…ë„ ì›”ë“œ ë¨¼ì € ë°©ë¬¸ (ì¸ê¸° ìµœê³ ). ë§ˆë¦¬ì˜¤ ì¹´íŠ¸ íƒ‘ìŠ¹.", type: "Play", icon: "ğŸ„" },
                    { time: "12:00", title: "ìƒë¶€ ë¡œíŠ¸(Upper Lot) ì´ë™ & ì ì‹¬", desc: "ì‹¬ìŠ¨ ë¼ì´ë“œ ê·¼ì²˜ í˜¹ì€ í•´ë¦¬í¬í„° êµ¬ì—­ì—ì„œ ì ì‹¬.", type: "Food", icon: "ğŸ”" },
                    { time: "13:30", title: "ìŠ¤íŠœë””ì˜¤ íˆ¬ì–´ & ë¯¸ë‹ˆì–¸ì¦ˆ", desc: "ì•‰ì•„ì„œ ê´€ëŒí•˜ëŠ” ìŠ¤íŠœë””ì˜¤ íˆ¬ì–´ë¡œ ì²´ë ¥ ì•ˆë°° í›„ ë¯¸ë‹ˆì–¸ì¦ˆ êµ¬ì—­ ì¦ê¸°ê¸°.", type: "Play", icon: "ğŸšŒ" },
                    { time: "17:00", title: "ì›Œí„°ì›”ë“œ ì‡¼ & ê¸°ë…í’ˆ", desc: "í™”ë ¤í•œ ì•¡ì…˜ ì‡¼ ê´€ëŒ í›„ ì‹œí‹°ì›Œí¬ êµ¬ê²½ ë° í‡´ì¥.", type: "Walk", icon: "ğŸŒŠ" }
                ],
                tips: [
                    "ìµìŠ¤í”„ë ˆìŠ¤ í‹°ì¼“ì´ ì—†ë‹¤ë©´ ê°œì¥ ì‹œê°„ì— ë§ì¶° ì…ì¥í•˜ì„¸ìš”.",
                    "5ì„¸ ì•„ì´ì—ê²Œ í•´ë¦¬í¬í„° ë†€ì´ê¸°êµ¬ëŠ” ë¬´ì„œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'í”Œë¼ì´íŠ¸ ì˜¤ë¸Œ íˆí¬ê·¸ë¦¬í”„' ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤.",
                    "ìŠ¤íŠœë””ì˜¤ íˆ¬ì–´ëŠ” ì•½ 1ì‹œê°„ ì†Œìš”ë˜ë©° ì•‰ì•„ì„œ ì‰´ ìˆ˜ ìˆëŠ” ì¢‹ì€ ê¸°íšŒì…ë‹ˆë‹¤."
                ],
                mapPoints: [
                    { x: 0, y: 0, name: "í˜¸í…”(Westwood)", color: "#10b981", size: 20 },
                    { x: 5, y: 6, name: "ìœ ë‹ˆë²„ì…œ ìŠ¤íŠœë””ì˜¤", color: "#8b5cf6", size: 25 }
                ],
                energyLabels: ["09:00", "11:00", "13:00", "15:00", "17:00", "19:00"],
                energyData: [100, 90, 60, 50, 40, 10], // Fast drain
                checklist: [
                    "ì…ì¥ê¶Œ QRì½”ë“œ ìº¡ì²˜", "ë³´ì¡°ë°°í„°ë¦¬", "ì—¬ë²Œ ì˜· (ì›Œí„°ì›”ë“œ ë¬¼íŠ ì£¼ì˜)", "ê°„ë‹¨í•œ ê°„ì‹"
                ]
            }
        ];

        let currentDayIndex = 0;
        let energyChartInstance = null;

        // --- Core Logic ---

        // Fixed: Renamed from renderDay to switchDay to match HTML onclick events
        function switchDay(index) {
            currentDayIndex = index;
            const data = dayData[index];

            // 1. Update Tabs
            [0, 1, 2].forEach(i => {
                const btn = document.getElementById(`tab-${i}`);
                if (i === index) {
                    btn.className = "tab-active flex-1 py-4 px-1 text-center text-sm md:text-base transition-colors duration-200 bg-amber-50 rounded-t-lg";
                } else {
                    btn.className = "tab-inactive flex-1 py-4 px-1 text-center text-sm md:text-base transition-colors duration-200 hover:bg-gray-50";
                }
            });

            // 2. Update Itinerary Cards
            const container = document.getElementById('itinerary-container');
            container.innerHTML = '';
            data.activities.forEach(act => {
                const card = document.createElement('div');
                card.className = "bg-white p-4 rounded-lg border border-gray-100 card-shadow flex gap-4 hover:border-amber-300 transition-all";
                card.innerHTML = `
                    <div class="flex flex-col items-center justify-center min-w-[60px]">
                        <span class="text-2xl">${act.icon}</span>
                        <span class="text-xs font-bold text-gray-500 mt-1">${act.time}</span>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">${act.title}</h4>
                        <p class="text-sm text-gray-600 mt-1">${act.desc}</p>
                    </div>
                `;
                container.appendChild(card);
            });

            // 3. Update Tips
            const tipsContainer = document.getElementById('daily-tips');
            tipsContainer.innerHTML = data.tips.map(tip => `<li class="flex items-start"><span class="mr-2">â€¢</span>${tip}</li>`).join('');

            // 4. Update Checklist
            const checkContainer = document.getElementById('checklist-container');
            checkContainer.innerHTML = data.checklist.map((item, i) => `
                <div class="flex items-center p-2 rounded hover:bg-gray-50 cursor-pointer" onclick="toggleCheck(this)">
                    <div class="w-5 h-5 border-2 border-amber-400 rounded mr-3 flex items-center justify-center text-white check-box transition-colors">âœ“</div>
                    <span class="text-sm text-gray-700 select-none">${item}</span>
                </div>
            `).join('');

            // 5. Update Map (Plotly)
            updateMap(data.mapPoints);

            // 6. Update Energy Chart (Chart.js)
            updateEnergyChart(data.energyLabels, data.energyData);
        }

        // --- Visualization Functions ---

        function updateMap(points) {
            const trace = {
                x: points.map(p => p.x),
                y: points.map(p => p.y),
                text: points.map(p => p.name),
                mode: 'markers+text',
                type: 'scatter',
                textposition: 'top center',
                marker: {
                    size: points.map(p => p.size),
                    color: points.map(p => p.color),
                    line: { width: 2, color: '#fff' }
                },
                hoverinfo: 'text'
            };

            const layout = {
                margin: { t: 20, b: 20, l: 20, r: 20 },
                xaxis: { showgrid: true, zeroline: false, showticklabels: false, range: [-6, 8] },
                yaxis: { showgrid: true, zeroline: false, showticklabels: false, range: [-4, 8] },
                dragmode: false,
                paper_bgcolor: '#f9fafb',
                plot_bgcolor: '#f9fafb',
                showlegend: false
            };

            const config = { responsive: true, displayModeBar: false };
            Plotly.newPlot('map-plot', [trace], layout, config);
        }

        function updateEnergyChart(labels, data) {
            const ctx = document.getElementById('energyChart').getContext('2d');
            
            if (energyChartInstance) {
                energyChartInstance.destroy();
            }

            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(245, 158, 11, 0.5)'); // Amber
            gradient.addColorStop(1, 'rgba(245, 158, 11, 0.0)');

            energyChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì•„ì´ ì—ë„ˆì§€ ë ˆë²¨',
                        data: data,
                        borderColor: '#f59e0b',
                        backgroundColor: gradient,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#d97706',
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let val = context.raw;
                                    if (val > 80) return `âš¡ ì—ë„ˆì§€ ë¿œë¿œ! (${val}%)`;
                                    if (val > 50) return `ğŸ™‚ í™œë™í•˜ê¸° ì¢‹ì•„ìš” (${val}%)`;
                                    if (val > 20) return `ğŸ¥± íœ´ì‹ì´ í•„ìš”í•´ìš” (${val}%)`;
                                    return `ğŸ˜´ ì¡¸ë ¤ìš”... (${val}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            min: 0,
                            max: 100,
                            display: true,
                            title: { display: true, text: 'í™œë ¥ë„ (%)' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // --- Utility Functions ---

        function toggleCheck(el) {
            const box = el.querySelector('.check-box');
            const text = el.querySelector('span');
            
            if (box.classList.contains('bg-amber-500')) {
                box.classList.remove('bg-amber-500');
                text.classList.remove('line-through', 'text-gray-400');
            } else {
                box.classList.add('bg-amber-500');
                text.classList.add('line-through', 'text-gray-400');
            }
        }

        function toggleSafetyDetails() {
            const details = document.getElementById('safety-details');
            if (details.style.display === 'none') {
                details.style.display = 'grid';
            } else {
                details.style.display = 'none';
            }
        }

        // Initialize
        window.onload = () => {
            switchDay(0); // Fixed: Changed from renderDay to switchDay
            // Default show details for safety on large screens
            if (window.innerWidth < 768) {
                document.getElementById('safety-details').style.display = 'none';
            }
        };

        // Resize handler for charts
        window.addEventListener('resize', () => {
            if(energyChartInstance) energyChartInstance.resize();
            Plotly.Plots.resize('map-plot');
        });

    </script>
</body>
</html>
